<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="easyRT">
<title>Drift Diffusion Model (DDM) in R: A Tutorial • easyRT</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Drift Diffusion Model (DDM) in R: A Tutorial">
<meta property="og:description" content="easyRT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">easyRT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/ddm.html">DDMs</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/exgaussian.html">Ex-Gaussian</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Drift Diffusion Model (DDM) in R: A Tutorial</h1>
            
      
      
      <div class="d-none name"><code>ddm.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>If you haven’t, install the <strong>easyRT</strong> package by
running:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"DominiqueMakowski/easyRT"</span><span class="op">)</span></span></code></pre></div>
<p>Load the necessary packages.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/easystats/easystats" class="external-link">easystats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">easyRT</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>DDMs appear to be quite complicated to implement. I tried to use
<em>HDDM</em> and <em>PyDDM</em> in Python, and had a look at R
alternatives, but I didn’t find any solution that was easy to use and
flexible enough (for my use-case) out-of-the-box. It seems like the
powerful <em>brms</em> is currently the best way to approach that,
though it has a steep learning curve… Thus, a massive thanks to <span class="citation">@singmann</span>, that made <a href="http://singmann.org/wiener-model-analysis-with-brms-part-i/" class="external-link">this
blogpost</a>, the <a href="https://github.com/rtdists/rtdists/" class="external-link">rtdists</a> and <a href="https://github.com/rtdists/fddm" class="external-link">fddm</a> packages.</p>
</div>
<div class="section level2">
<h2 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h2>
<div class="figure">
<img src="../reference/figures/wiener_example.webp" alt=""><p class="caption"><em>A graphical illustration of the Wiener diffusion
model for two-choice reaction times. An evidence counter starts at value
<span class="math inline">\(\alpha*\beta\)</span> and evolves with
random increments. The mean increment is <span class="math inline">\(\delta\)</span> . The process terminates as soon
as the accrued evidence exceeds <span class="math inline">\(\alpha\)</span> or deceeds 0. The decision process
starts at time <span class="math inline">\(\tau\)</span> from the
stimulus presentation and terminates at the reaction time. This figure
is from Wabersich and Vandekerckhove (2014).</em></p>
</div>
<p>Drift Diffusion Models, aka Diffusion Decision Model, aka DDMs are a
class of <strong>sequential models</strong> that model RT as a drifting
process towards a response. They are useful to jointly model reaction
time and a binary outcome, such as 2 different choices or accuracy
(i.e., “correct” vs “error”). They are based on Wiener distributions
that are defined by 4 parameters:</p>
<ul>
<li>
<strong>drift</strong>: The <strong>drift</strong> rate (delta <span class="math inline">\(\delta\)</span>) is the average slope of the
accumulation process towards the boundaries. The larger the (absolute
value of the) drift rate, the more effective the evidence accumulation
for the corresponding response option. A drift rate close to 0 suggests
an ambiguous stimulus. Typical range: [-5, 5].</li>
<li>
<strong>bs</strong>: The <strong>boundary separation</strong>
threshold (alpha <span class="math inline">\(\alpha\)</span>) is the
distance between the two decision bounds and interpreted as a measure of
response caution (i.e., of speed-accuracy trade-off, with high
<em>bs</em> being related to high accuracy). It represents the amount of
evidence that is needed to make a response. Typical range: [0.5,
2].</li>
<li>
<strong>bias</strong>: Initial bias (beta <span class="math inline">\(\beta\)</span>) for any of the responses. The
starting point of the accumulation process. Typical range: [0.3,
0.7].</li>
<li>
<strong>ndt</strong>: The <strong>non-decision time</strong> (tau
<span class="math inline">\(\tau\)</span>) captures all non-decisional
process, such as stimulus encoding, motor processes, etc. Typical range:
[0.1, 0.5] s.</li>
</ul>
<p>Additional variability parameters can include:</p>
<ul>
<li>
<strong>ndt_var</strong>: Also called <code>st0</code>. Typical
range: [0, 0.2] s.</li>
</ul>
</div>
<div class="section level2">
<h2 id="simple-example">Simple Example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>In this example, we are going to simulate data for 4 conditions with
<em>known</em> parameters, and we will investigate how we can then model
and recover these parameters.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ddm_data.html">ddm_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">200</span>, <span class="fl">200</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>                drift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                bs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>                ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ddm_plot.html">ddm_plot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-5-1.png" width="6000"></p>
<ul>
<li>Condition 1: <span class="math inline">\(drift~\delta =
-1,~bias~\beta = 0.4\)</span>
</li>
<li>Condition 2: <span class="math inline">\(drift~\delta =
0,~bias~\beta = 0.5\)</span>
</li>
<li>Condition 3: <span class="math inline">\(drift~\delta =
1,~bias~\beta = 0.6\)</span>
</li>
<li>Condition 4: <span class="math inline">\(drift~\delta =
2,~bias~\beta = 0.7\)</span>
</li>
</ul>
<p>Boundary separation <em>bs</em> and <em>ndt</em> have been fixed to 1
and 0.15 for all conditions. Let’s visualize the raw data and the
theoretical distribution it comes from.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          rt response condition</span></span>
<span><span class="co">## 1 0.3283990    lower         1</span></span>
<span><span class="co">## 2 0.2857288    lower         1</span></span>
<span><span class="co">## 3 0.4052673    lower         1</span></span>
<span><span class="co">## 4 0.3514263    lower         1</span></span>
<span><span class="co">## 5 0.4020190    lower         1</span></span>
<span><span class="co">## 6 0.3850511    lower         1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fddm">FDDM<a class="anchor" aria-label="anchor" href="#fddm"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">fddm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fddm/man/ddm.html" class="external-link">ddm</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">+</span> <span class="va">response</span> <span class="op">~</span> <span class="va">condition</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, <code>fdmm</code> doesn’t seem to work and throws the
following error:</p>
<pre><code>Error in nlminb(start = init, objective = objective, gradient = gradient,  :
  NA/NaN gradient evaluation</code></pre>
</div>
<div class="section level3">
<h3 id="formula">Formula<a class="anchor" aria-label="anchor" href="#formula"></a>
</h3>
<p>Let’s start with modelling only the drift rate.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">|</span> <span class="fu">dec</span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">condition</span><span class="op">)</span></span>
<span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html" class="external-link">wiener</a></span><span class="op">(</span>link_bs <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 link_ndt <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 link_bias <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<p><span class="citation">@singmaann</span> <a href="http://singmann.org/wiener-model-analysis-with-brms-part-i/" class="external-link">gives
this</a> rationale for setting an <code>identity</code> link:</p>
<blockquote>
<p><em>Because the drift rate can take on any value (i.e., from -Inf to
Inf), the default link function is “identity” (i.e., no transformation)
which we retain. The other three parameters all have a restricted range.
The boundary needs to be larger than 0, the non-decision time needs to
be larger than 0 and smaller than the smallest RT, and the starting
point needs to be between 0 and 1. The default link-functions respect
these constraints and use “log” for the first two parameters and “logit”
for the bias. This certainly is a possibility, but has a number of
drawbacks leading me to use the “identity” link function for all
parameters. First, when parameters are transformed, the priors need to
be specified on the untransformed scale. Second, the individual-levels
deviations (i.e., the random-effects estimates) are assumed to come from
a multivariate normal distribution. Parameters transformations would
entail that these individual-deviations are only normally distributed on
the untransformed scale. Likewise, the correlations of parameter
deviations across parameters would also be on the untransformed scale.
Both make the interpretation of the random-effects difficult.</em></p>
</blockquote>
<blockquote>
<p><em>When specifying the parameters without transformation (i.e., link
= “identity”) care must be taken that the priors places most mass on
values inside the allowed range. Likewise, starting values need to be
inside the allowed range. Using the identity link function also comes
with drawbacks discussed at the end. However, as long as parameter
outside the allowed range only occur rarely, such a model can converge
successfully and it makes the interpretation easier.</em></p>
</blockquote>
</div>
<div class="section level3">
<h3 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h3>
<ul>
<li>
<strong>b</strong>: Our priors on the effect of conditions on the
drift rate are centred around 0 and give enough probability mass to
plausible values (the typical range for drift being [-5, 5]). A student
distribution has fatter tails than a Gaussian one, dealing better with
outliers (a Cauchy distribution would also be a good alternative).</li>
<li>
<strong>ndt</strong>: Our priors on the non-decision time is a
<em>gamma</em> distribution, that naturally excludes 0. We set it
slightly skewed to the left, so that most of the mass covers the 0 - 0.5
s (we don’t expect non-decision processes to take more than 0.5 s). Note
that there is an upper bound set at the minimum RT value.</li>
<li>
<strong>bs</strong>: Our priors on the boundary separation is a
wider <em>gamma</em> distribution (excluding 0), with a likelihood
peaking around 1.</li>
<li>
<strong>bias</strong>: Our priors is a <em>beta</em> distribution
(naturally bounded at <span class="math inline">\(]0, 1[\)</span>)
centered around 0.5.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get_prior(formula, data = df, family = family)</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 2)"</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"gamma(1.5, 3)"</span>, class <span class="op">=</span> <span class="st">"ndt"</span>, ub <span class="op">=</span> <span class="st">"min_Y"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"gamma(3, 2)"</span>, class <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"beta(1.3, 1.3)"</span>, class <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>                           family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_data</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">:::</span><span class="fu">prepare_print_prior</span><span class="op">(</span><span class="va">prior</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ub</span> <span class="op">==</span> <span class="st">"min_Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>, <span class="va">ub</span><span class="op">)</span>,</span>
<span>         Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">!=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">class</span>, <span class="st">"_"</span>, <span class="va">coef</span><span class="op">)</span>, <span class="va">class</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameter</span> <span class="op">!=</span> <span class="st">"b"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/parse_dist.html" class="external-link">parse_dist</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span></span>
<span></span>
<span><span class="va">prior_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Parameter</span>, xdist <span class="op">=</span> <span class="va">.dist_obj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"slab"</span>, n <span class="op">=</span> <span class="fl">10001</span>, normalize<span class="op">=</span><span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_vline(xintercept = 0.3) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Priors"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="sampling">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chain_id</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bias <span class="op">=</span> <span class="fl">0.5</span>, bs <span class="op">=</span> <span class="fl">1</span> , ndt <span class="op">=</span> <span class="fl">0.2</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># str(m$fit@inits)</span></span>
<span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>         data <span class="op">=</span> <span class="va">df</span>,</span>
<span>         family <span class="op">=</span> <span class="va">family</span>,</span>
<span>         prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>         algorithm <span class="op">=</span> <span class="st">"sampling"</span>,</span>
<span>         init <span class="op">=</span> <span class="va">init_func</span><span class="op">)</span></span>
<span>         </span>
<span>         <span class="co"># # If using `algorithm = "fullrank"`, add the following:</span></span>
<span>         <span class="co"># iter = 10000, # N of convergence iterations, defaults to 2000.</span></span>
<span>         <span class="co"># output_samples = 4000, # N of posterior samples to draw and save, defaults to 1000.</span></span>
<span>         <span class="co"># elbo_samples = 100, # N of samples for Monte Carlo estimate of ELBO (objective function), defaults to 100.</span></span>
<span>         <span class="co"># tol_rel_obj = 0.01, # convergence tolerance on the relative norm of the objective, defaults to 0.01.</span></span>
<span>         <span class="co"># importance_resampling = TRUE # adjust the draws at the optimum to be more like draws from the posterior distribution</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span></code></pre></div>
<pre><code><span><span class="co">##  Family: wiener </span></span>
<span><span class="co">##   Links: mu = identity; bs = identity; ndt = identity; bias = identity </span></span>
<span><span class="co">## Formula: rt | dec(response) ~ 0 + condition </span></span>
<span><span class="co">##    Data: df (Number of observations: 800) </span></span>
<span><span class="co">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">##          total post-warmup draws = 4000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Population-Level Effects: </span></span>
<span><span class="co">##            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## condition1    -1.47      0.15    -1.76    -1.17 1.00     4274     2862</span></span>
<span><span class="co">## condition2    -0.15      0.14    -0.42     0.13 1.00     4090     3158</span></span>
<span><span class="co">## condition3     1.29      0.15     0.99     1.58 1.00     4500     3172</span></span>
<span><span class="co">## condition4     2.47      0.18     2.12     2.83 1.00     4634     2823</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family Specific Parameters: </span></span>
<span><span class="co">##      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## bs       1.13      0.02     1.09     1.17 1.00     4429     3429</span></span>
<span><span class="co">## ndt      0.20      0.00     0.19     0.20 1.00     4195     3120</span></span>
<span><span class="co">## bias     0.52      0.01     0.50     0.55 1.00     2882     2927</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"b_"</span><span class="op">)</span>, <span class="va">bs</span>, <span class="va">ndt</span>, <span class="va">bias</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_long.html" class="external-link">data_to_long</a></span><span class="op">(</span>names_to<span class="op">=</span><span class="st">"Parameter"</span>, rows_to <span class="op">=</span> <span class="st">"iter"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prior_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xdist <span class="op">=</span> <span class="va">.dist_obj</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"slab"</span>, n <span class="op">=</span> <span class="fl">10001</span>, normalize<span class="op">=</span><span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggdist::stat_dotsinterval(aes(x = value, fill = Parameter), color = "black", slab_linewidth = NA, scale = 1, dotsize = 2, normalize = "xy") +</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slabinterval.html" class="external-link">stat_slabinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span>, slab_linewidth <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="fl">1</span>, normalize <span class="op">=</span> <span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="posterior-predictive-check">Posterior Predictive Check<a class="anchor" aria-label="anchor" href="#posterior-predictive-check"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html" class="external-link">pp_check</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># performance::check_predictions(m)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">get_predicted</span><span class="op">(</span><span class="va">m</span>, predict <span class="op">=</span> <span class="st">"prediction"</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># posterior_predict(m, newdata=df, draws = 10)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ddm_plot.html">ddm_plot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">df</span>, rt <span class="op">=</span> <span class="va">Predicted</span><span class="op">)</span>, density <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">density</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-12-2.png" width="700"></p>
<p><em>Note: I am not sure why the predictions (got with
<code>get_predicted()</code>) are so off…</em></p>
</div>
</div>
<div class="section level2">
<h2 id="better-model">Better Model<a class="anchor" aria-label="anchor" href="#better-model"></a>
</h2>
<div class="section level3">
<h3 id="formula-1">Formula<a class="anchor" aria-label="anchor" href="#formula-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span><span class="va">rt</span> <span class="op">|</span> <span class="fu">dec</span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">Intercept</span> <span class="op">+</span> <span class="va">condition</span>,</span>
<span>              <span class="va">bias</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">Intercept</span> <span class="op">+</span> <span class="va">condition</span><span class="op">)</span></span>
<span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brmsfamily.html" class="external-link">wiener</a></span><span class="op">(</span>link_bs <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 link_ndt <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                 link_bias <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="priors-1">Priors<a class="anchor" aria-label="anchor" href="#priors-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get_prior(formula, data = df, family = family)</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 1)"</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef<span class="op">=</span><span class="st">"condition"</span>, dpar <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 1)"</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef<span class="op">=</span><span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"student_t(3, 0, 0.05)"</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef<span class="op">=</span><span class="st">"condition"</span>, dpar <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"normal(0.5, 0.15)"</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"Intercept"</span>, dpar <span class="op">=</span> <span class="st">"bias"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"gamma(1.5, 3)"</span>, class <span class="op">=</span> <span class="st">"ndt"</span>, ub <span class="op">=</span> <span class="st">"min_Y"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/brms/man/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span><span class="st">"gamma(3, 2)"</span>, class <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brms/man/validate_prior.html" class="external-link">validate_prior</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>                           family <span class="op">=</span> <span class="va">family</span>,</span>
<span>                           data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">prior_data</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">:::</span><span class="fu">prepare_print_prior</span><span class="op">(</span><span class="va">prior</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">prior</span> <span class="op">!=</span> <span class="st">"(flat)"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ub</span> <span class="op">==</span> <span class="st">"min_Y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rt</span><span class="op">)</span>, <span class="va">ub</span><span class="op">)</span>,</span>
<span>         Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">coef</span> <span class="op">!=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">class</span>, <span class="st">"_"</span>, <span class="va">coef</span><span class="op">)</span>, <span class="va">class</span><span class="op">)</span>, </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dpar</span> <span class="op">!=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="va">dpar</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/parse_dist.html" class="external-link">parse_dist</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span></span>
<span></span>
<span><span class="va">prior_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Parameter</span>, xdist <span class="op">=</span> <span class="va">.dist_obj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"slab"</span>, n <span class="op">=</span> <span class="fl">10001</span>, normalize<span class="op">=</span><span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_vline(xintercept = 0.3) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Priors"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="sampling-1">Sampling<a class="anchor" aria-label="anchor" href="#sampling-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># stancode(m)</span></span>
<span><span class="va">init_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">chain_id</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       b_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>       bs <span class="op">=</span> <span class="fl">1</span>, ndt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># m$fit@inits</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brm</a></span><span class="op">(</span><span class="va">formula</span>,</span>
<span>         data <span class="op">=</span> <span class="va">df</span>,</span>
<span>         family <span class="op">=</span> <span class="va">family</span>,</span>
<span>         prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>         algorithm <span class="op">=</span> <span class="st">"sampling"</span>,</span>
<span>         init <span class="op">=</span> <span class="va">init_func</span><span class="op">)</span></span>
<span>         </span>
<span>         <span class="co"># # If using `algorithm = "fullrank"`, add the following:</span></span>
<span>         <span class="co"># iter = 10000, # N of convergence iterations, defaults to 2000.</span></span>
<span>         <span class="co"># output_samples = 4000, # N of posterior samples to draw and save, defaults to 1000.</span></span>
<span>         <span class="co"># elbo_samples = 100, # N of samples for Monte Carlo estimate of ELBO (objective function), defaults to 100.</span></span>
<span>         <span class="co"># tol_rel_obj = 0.01, # convergence tolerance on the relative norm of the objective, defaults to 0.01.</span></span>
<span>         <span class="co"># importance_resampling = TRUE # adjust the draws at the optimum to be more like draws from the posterior distribution</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span></span></code></pre></div>
<pre><code><span><span class="co">##  Family: wiener </span></span>
<span><span class="co">##   Links: mu = identity; bs = identity; ndt = identity; bias = identity </span></span>
<span><span class="co">## Formula: rt | dec(response) ~ 0 + Intercept + condition </span></span>
<span><span class="co">##          bias ~ 0 + Intercept + condition</span></span>
<span><span class="co">##    Data: df (Number of observations: 800) </span></span>
<span><span class="co">##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">##          total post-warmup draws = 4000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Population-Level Effects: </span></span>
<span><span class="co">##                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## Intercept         -1.25      0.14    -1.53    -0.96 1.00     1784     2219</span></span>
<span><span class="co">## condition          1.19      0.09     1.02     1.36 1.00     1612     2361</span></span>
<span><span class="co">## bias_Intercept     0.48      0.02     0.44     0.52 1.00     1961     2428</span></span>
<span><span class="co">## bias_condition     0.03      0.01     0.01     0.05 1.00     1842     2092</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Family Specific Parameters: </span></span>
<span><span class="co">##     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">## bs      1.14      0.02     1.10     1.18 1.00     3076     2768</span></span>
<span><span class="co">## ndt     0.20      0.00     0.19     0.20 1.00     2877     2305</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">## and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">## scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>b_condition_bias <span class="op">=</span> <span class="va">b_bias_condition</span>, b_Intercept_bias <span class="op">=</span> <span class="va">b_bias_Intercept</span>, <span class="va">b_condition</span>, <span class="va">b_Intercept</span>, <span class="va">bs</span>, <span class="va">ndt</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">datawizard</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/datawizard/reference/data_to_long.html" class="external-link">data_to_long</a></span><span class="op">(</span>names_to<span class="op">=</span><span class="st">"Parameter"</span>, rows_to <span class="op">=</span> <span class="st">"iter"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_halfeye.html" class="external-link">stat_halfeye</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prior_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xdist <span class="op">=</span> <span class="va">.dist_obj</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"slab"</span>, n <span class="op">=</span> <span class="fl">10001</span>, normalize<span class="op">=</span><span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggdist::stat_dotsinterval(aes(x = value, fill = Parameter), color = "black", slab_linewidth = NA, scale = 1, dotsize = 2, normalize = "xy") +</span></span>
<span>  <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_slabinterval.html" class="external-link">stat_slabinterval</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">Parameter</span><span class="op">)</span>, slab_linewidth <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="fl">1</span>, normalize <span class="op">=</span> <span class="st">"xy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="posterior-predictive-check-1">Posterior Predictive Check<a class="anchor" aria-label="anchor" href="#posterior-predictive-check-1"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html" class="external-link">pp_check</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># performance::check_predictions(m)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">get_predicted</span><span class="op">(</span><span class="va">m</span>, predict <span class="op">=</span> <span class="st">"prediction"</span>, iterations <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># posterior_predict(m, newdata=df, draws = 10)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ddm_plot.html">ddm_plot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">df</span>, rt <span class="op">=</span> <span class="va">Predicted</span>, condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span>, density <span class="op">=</span> <span class="va">sim</span><span class="op">$</span><span class="va">density</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ddm_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dominique Makowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
